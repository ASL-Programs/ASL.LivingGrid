@page "/visual-editor"
@inject IJSRuntime JS

<h3>Realtime Visual Editor</h3>
<div class="row">
    <div class="col-md-6">
        <textarea class="form-control" style="height:300px" @bind="html" @bind:event="oninput"></textarea>
    </div>
    <div class="col-md-6">
        <iframe id="preview" class="w-100" style="height:300px"></iframe>
    </div>
</div>

@code {
    private string html = "<h1>Hello</h1>";

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        await JS.InvokeVoidAsync("eval", $"document.getElementById('preview').contentDocument.body.innerHTML = `{EscapeHtml(html)}`;");
    }

    private static string EscapeHtml(string input) => input.Replace("`", "\\`");
}
