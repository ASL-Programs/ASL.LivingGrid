@using Microsoft.AspNetCore.Components.Authorization
@using ASL.LivingGrid.WebAdminPanel.Services
@using ASL.LivingGrid.WebAdminPanel.Models
@inject ILocalizationService LocalizationService
@inject INavigationService NavService
@inject NavigationManager Navigation
@inject IJSRuntime JSRuntime

<div class="top-row ps-3 navbar navbar-dark">
    <div class="container-fluid">
        <a class="navbar-brand" href="/">ASL LivingGrid</a>
    </div>
</div>

<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#sidebarMenu" aria-controls="sidebarMenu" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
</button>

<div id="sidebarMenuContent" class="nav-scrollable collapse show">
    <nav class="flex-column">
        @foreach (var item in menuItems)
        {
            <div class="nav-item px-3">
                <NavLink class="nav-link" href="@item.Url" Match="NavLinkMatch.Prefix">
                    <span class="@item.Icon" aria-hidden="true"></span> @localizedStrings[item.Key]
                </NavLink>
            </div>
        }
    </nav>
</div>

@code {
    private Dictionary<string, string> localizedStrings = new();
    private IEnumerable<NavigationItem> menuItems = Enumerable.Empty<NavigationItem>();

    protected override async Task OnInitializedAsync()
    {
        localizedStrings = await LocalizationService.GetAllStringsAsync("az"); // Default to Azerbaijani
        if (!localizedStrings.ContainsKey("Navigation.Dashboard"))
        {
            localizedStrings["Navigation.Dashboard"] = "İdarə paneli";
            localizedStrings["Navigation.Companies"] = "Şirkətlər";
            localizedStrings["Navigation.Users"] = "İstifadəçilər";
            localizedStrings["Navigation.Roles"] = "Rollar";
            localizedStrings["Navigation.Settings"] = "Ayarlar";
            localizedStrings["Navigation.Audit"] = "Audit";
            localizedStrings["Navigation.Notifications"] = "Bildirişlər";
            localizedStrings["Navigation.Plugins"] = "Pluginlər";
            localizedStrings["Navigation.UIAudit"] = "UI Audit";
            localizedStrings["Navigation.DashboardDesigner"] = "Panel Dizaynı";
        }

        menuItems = await NavService.GetMenuItemsAsync();
    }
}
